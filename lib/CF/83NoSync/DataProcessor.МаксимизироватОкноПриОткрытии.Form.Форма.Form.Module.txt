
&НаСервереБезКонтекста
Функция УзнатьНадоМаксимизировать()
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	Справочник2.Ссылка
		|ИЗ
		|	Справочник.Справочник2 КАК Справочник2";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Возврат Ложь;
	КонецЦикла;
	
	Возврат Истина;
КонецФункции	

&НаКлиенте
Процедура МаксимизироватьОкно()
	НадоМаксимизировать = УзнатьНадоМаксимизировать();
	
	//НадоМаксимизировать = Истина;
	
	Если НадоМаксимизировать Тогда
		WSHShell = Новый COMОбъект("WScript.Shell");
		WSHShell.SendKeys("%");
		WSHShell.SendKeys("{LEFT}{LEFT}{ENTER}");    
	КонецЕсли;	 
	
	ЭтаФорма.Закрыть();
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	СисИнфо = Новый СистемнаяИнформация;
	Если Найти(Строка(СисИнфо.ТипПлатформы), "Linux")>0 Тогда 
		Отказ = Истина;
		Возврат;
	КонецЕсли;
	
	
	ПодключитьОбработчикОжидания("МаксимизироватьОкно",0.1,Истина);
КонецПроцедуры
